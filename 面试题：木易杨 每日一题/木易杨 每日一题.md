## æ¯æ—¥ä¸€é¢˜

> æ¯å¤©ä¸€é“å¤§å‚å‰ç«¯é¢è¯•é¢˜ï¼Œä¸€å¹´åå†å›å¤´ï¼Œä¼šæ„Ÿè°¢æ›¾ç»åŠªåŠ›çš„è‡ªå·±ï¼
>
> å¾…æ›´æ–°çŠ¶æ€
>
> ä»Šå¤© 2019/10/10  ~ ğŸ’ª



### [ç¬¬ 1 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/blob/master/datum/summary.md#%E7%AC%AC-1-%E9%A2%98%E5%86%99-react--vue-%E9%A1%B9%E7%9B%AE%E6%97%B6%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%9C%A8%E5%88%97%E8%A1%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E5%86%99-key%E5%85%B6%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88) ï¼ˆ2019/9/19ï¼‰

**é¢˜ç›®**ï¼šå†™ React / Vue é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨åˆ—è¡¨ç»„ä»¶ä¸­å†™ keyï¼Œå…¶ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

**å…¬å¸**ï¼šæ»´æ»´ã€é¥¿äº†ä¹ˆ

**éœ€äº†è§£** ï¼švueå’Œreactéƒ½æ˜¯é‡‡ç”¨diffç®—æ³•æ¥å¯¹æ¯”æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹ï¼Œä»è€Œæ›´æ–°èŠ‚ç‚¹ã€‚åœ¨vueçš„diffå‡½æ•°ä¸­ã€‚å¯ä»¥å…ˆäº†è§£ä¸€ä¸‹diffç®—æ³•ã€‚
åœ¨äº¤å‰å¯¹æ¯”çš„æ—¶å€™ï¼Œå½“æ–°èŠ‚ç‚¹è·Ÿæ—§èŠ‚ç‚¹`å¤´å°¾äº¤å‰å¯¹æ¯”`æ²¡æœ‰ç»“æœçš„æ—¶å€™ï¼Œä¼šæ ¹æ®æ–°èŠ‚ç‚¹çš„keyå»å¯¹æ¯”æ—§èŠ‚ç‚¹æ•°ç»„ä¸­çš„keyï¼Œä»è€Œæ‰¾åˆ°ç›¸åº”æ—§èŠ‚ç‚¹ï¼ˆè¿™é‡Œå¯¹åº”çš„æ˜¯ä¸€ä¸ªkey => index çš„mapæ˜ å°„ï¼‰ã€‚å¦‚æœæ²¡æ‰¾åˆ°å°±è®¤ä¸ºæ˜¯ä¸€ä¸ªæ–°å¢èŠ‚ç‚¹ã€‚è€Œå¦‚æœæ²¡æœ‰keyï¼Œé‚£ä¹ˆå°±ä¼šé‡‡ç”¨ä¸€ç§éå†æŸ¥æ‰¾çš„æ–¹å¼å»æ‰¾åˆ°å¯¹åº”çš„æ—§èŠ‚ç‚¹ã€‚ä¸€ç§ä¸€ä¸ªmapæ˜ å°„ï¼Œå¦ä¸€ç§æ˜¯éå†æŸ¥æ‰¾ã€‚ç›¸æ¯”è€Œè¨€ã€‚mapæ˜ å°„çš„é€Ÿåº¦æ›´å¿«ã€‚

**ç­”æ¡ˆ**ï¼š 

> keyæ˜¯ç»™æ¯ä¸€ä¸ªvnodeçš„å”¯ä¸€id,å¯ä»¥`ä¾é key`,æ›´`å‡†ç¡®`, æ›´`å¿«`çš„æ‹¿åˆ°oldVnodeä¸­å¯¹åº”çš„vnodeèŠ‚ç‚¹ã€‚
>
> keyçš„ä½œç”¨æ˜¯ä¸ºäº†åœ¨diffç®—æ³•æ‰§è¡Œæ—¶æ›´å¿«çš„æ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹ï¼Œæé«˜diffé€Ÿåº¦ã€‚

1ã€æ›´å‡†ç¡®

å› ä¸ºå¸¦keyå°±ä¸æ˜¯`å°±åœ°å¤ç”¨`äº†ï¼Œåœ¨sameNodeå‡½æ•° `a.key === b.key`å¯¹æ¯”ä¸­å¯ä»¥é¿å…å°±åœ°å¤ç”¨çš„æƒ…å†µã€‚æ‰€ä»¥ä¼šæ›´åŠ å‡†ç¡®ã€‚

2ã€æ›´å¿«

åˆ©ç”¨keyçš„å”¯ä¸€æ€§ç”Ÿæˆmapå¯¹è±¡æ¥è·å–å¯¹åº”èŠ‚ç‚¹ï¼Œæ¯”éå†æ–¹å¼æ›´å¿«ã€‚(è¿™ä¸ªè§‚ç‚¹ï¼Œå°±æ˜¯æˆ‘æœ€åˆçš„é‚£ä¸ªè§‚ç‚¹ã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œmapä¼šæ¯”éå†æ›´å¿«ã€‚)



### [ç¬¬ 2 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/4)ï¼ˆ2019/9/20ï¼‰

**é¢˜ç›®**ï¼š`['1', '2', '3'].map(parseInt)` what & why ?

**ç­”æ¡ˆ** ï¼šç¬¬ä¸€çœ¼çœ‹åˆ°è¿™ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œè„‘æµ·è·³å‡ºçš„ç­”æ¡ˆæ˜¯ [1, 2, 3]ï¼Œä½†æ˜¯ **çœŸæ­£çš„ç­”æ¡ˆæ˜¯[1, NaN, NaN]**ã€‚

```js
    console.log(parseInt('12'));//12
    console.log(parseInt('08'));//8
    console.log(parseInt('0x16')); //22
    console.log(parseInt('-12')); //-12
    console.log(parseInt('   -12'));//-12
    console.log(parseInt('   -  12'));///NAN
    console.log(parseInt('124ref')); //124
    console.log(parseInt('ref'));   //NAN
```

ä»¥ä¸Šå‡ ä¹å°±æ˜¯`parseInt`å‡½æ•°ä¸€ä¸ªå½¢å¼å‚æ•°æ—¶çš„æ‰€æœ‰æƒ…å†µ

radixå½¢å‚æ²¡æŒ‡å®šçš„æ—¶å€™æ˜¯**10**ï¼Œå…¶æ¬¡ä»–æ˜¯å…·æœ‰æœ‰æ•ˆèŒƒå›´æ»´ï¼š[2, 36]å’Œç‰¹æ®Šå€¼0
ä¸‹é¢æ˜¯è‹±è¯­æ¸£æ¸£çš„æˆ‘ç¿»è¯‘åï¼Œç®€åŒ–çš„`parseInt`æ‰§è¡Œæ­¥éª¤ï¼šï¼ˆECMAScriptåŸè§£æ->[ä¼ é€é—¨](http://www.ecma-international.org/ecma-262/6.0/#sec-parseint-string-radix)ï¼‰

1. å°†ç¬¬ä¸€ä¸ªå½¢å‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²
2. è¯†åˆ«stringè½¬æ¢æ˜¯å¦æœ‰**code unit**ï¼Œå¦‚æœæœ‰ -> `-`æ ‡è®°ä¸ºè´Ÿæ•°ï¼Œ`0x`æˆ–`0X`åˆ™æŠŠradixèµ‹å€¼ä¸º**16**
3. radixå½¢å‚ï¼ˆintç±»å‹ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™é‡æ–°èµ‹å€¼ï¼ˆä¼šå¯¹å®å‚è¿›è¡ŒInt32è½¬åŒ–ï¼Œæ— æ³•è½¬æ¢æˆintç±»å‹åˆ™ä¸ä¼šé‡æ–°èµ‹å€¼radixï¼‰
4. radixä¸º0ï¼Œåˆ™è®¾ç½®radixä¸ºé»˜è®¤å€¼10
5. å¦‚æœradixä¸º1ï¼Œæˆ–è€…å¤§äºç­‰äº37ï¼ŒparseIntç›´æ¥è¿”å›**NaN**
6. å¦‚æœradixä¸º[2, 36]æ—¶åˆ™ä»£è¡¨ï¼Œstringå‚æ•°åˆ†åˆ«æ˜¯äºŒè¿›åˆ¶ï¼Œä¸‰è¿›åˆ¶ï¼ˆå¦‚æœæœ‰å¾—è¯~ï¼‰...ä¸‰åå…­è¿›åˆ¶ç±»å‹
7. ç„¶åå¯¹stringè¿›è¡Œçš„radixè¿›åˆ¶ -> åè¿›åˆ¶è½¬æ¢

ä»¥ä¸Šå°±æ˜¯`parseInt`è½¬æ¢æ—¶çš„æ­¥éª¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥å¼€å§‹è§£é‡Š`['1', '2', '3'].map(parseInt)`
**at first, ç­”æ¡ˆæ˜¯[1, NaN, NaN]**

```js
(function (){
        var ret = ['1', '2', '3'].map((value, index)=>{
            console.log(value, index);
            return parseInt(value, index);
        });
        console.log(ret);
    })();
```

è¿™æ˜¯`['1', '2', '3'].map(parseInt)`å†…éƒ¨æ‰§è¡Œçš„å‰–æï¼Œ`value`å’Œ`index`ç›¸ä¿¡å¤§å®¶éƒ½æ‡‚ï¼Œä¸æ‡‚è¯·è‡ªè¡Œ[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/map),æ‰§è¡Œæ­¥éª¤ä¸ºï¼š
`value='1',index=0` -> `parseInt(value, index)`
`value='2',index=1` -> `parseInt(value, index)`
`value='3',index=2` -> `parseInt(value, index)`
æŠ½ç¦»å‡ºæ¥ï¼Œå…¶å®å°±æ˜¯

```js
parseInt('1', 0);
parseInt('2', 1);
parseInt('3', 2);
```

`parseInt('3', 2)`è¿™æ˜¯æ ¹æ®äºŒè¿›åˆ¶å¯¹å­—ç¬¦ä¸²`3`è¿›è¡Œåè¿›åˆ¶è½¬æ¢å¯¹å§ï¼ï¼ï¼
exm???æœ‰æ¯›ç—…?æ²¡æ¯›ç—…ï¼Œè€é“ï¼Œå°±æ˜¯......ä½ å®¶äºŒè¿›åˆ¶æœ‰`3`?äºŒè¿›åˆ¶ä¸å°±æ˜¯`0`å’Œ`1`å•Š

å› æ­¤è¿”å›**NaN**ã€‚



### [ç¬¬ 3 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/5)ï¼ˆ2019/9/21ï¼‰

**é¢˜ç›®**ï¼šä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ

**å…¬å¸** ï¼šæŒ–è´¢

**è§£æ** ï¼š

1ã€**é˜²æŠ–**

> è§¦å‘é«˜é¢‘äº‹ä»¶ånç§’å†…å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœnç§’å†…é«˜é¢‘äº‹ä»¶å†æ¬¡è¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡ç®—æ—¶é—´

æ€è·¯ï¼š

> æ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶éƒ½å–æ¶ˆä¹‹å‰çš„å»¶æ—¶è°ƒç”¨æ–¹æ³•

```js
    function debounce(fn,delay) {
        let timeout = null // åˆ›å»ºä¸€ä¸ªæ ‡è®°ç”¨æ¥å­˜æ”¾å®šæ—¶å™¨çš„è¿”å›å€¼
        return function () {
            clearTimeout(timeout) // æ¯å½“ç”¨æˆ·è¾“å…¥çš„æ—¶å€™æŠŠå‰ä¸€ä¸ª setTimeout clear æ‰
            timeout = setTimeout(() => { // ç„¶ååˆåˆ›å»ºä¸€ä¸ªæ–°çš„ setTimeout, è¿™æ ·å°±èƒ½ä¿è¯è¾“å…¥å­—ç¬¦åçš„ interval é—´éš”å†…å¦‚æœè¿˜æœ‰å­—ç¬¦è¾“å…¥çš„è¯ï¼Œå°±ä¸ä¼šæ‰§è¡Œ fn å‡½æ•°
                fn.apply(this, arguments)
        }, delay)
        };
    }
    function sayHi() {
        console.log('é˜²æŠ–æˆåŠŸ');
    }

    var inp = document.getElementById('inp')
    inp.addEventListener('input', debounce(sayHi,500)) // é˜²æŠ–
```

æå‡ºé—®é¢˜ï¼šè¯·é—®ï¼Œä¸ºä»€ä¹ˆè¦ fn.apply(this, arguments);è€Œä¸æ˜¯è¿™æ · fn()

è§£ç­”ï¼šåŠ ä¸Š apply ç¡®ä¿ åœ¨ sayHi å‡½æ•°é‡Œçš„ this æŒ‡å‘çš„æ˜¯ inputå¯¹è±¡(ä¸ç„¶å°±æŒ‡å‘ window äº†ï¼Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„)ã€‚
è¿™é‡Œçš„ç®­å¤´å‡½æ•°ä¾æ—§æ˜¯æŒ‡å‘ input å¯¹è±¡ã€‚

![mark](http://static.zxinc520.com/blog/20190921/g4jPyh09vVh7.gif)

é˜²æŠ–åº”ç”¨åœºæ™¯ï¼š

1. æœç´¢æ¡†è¾“å…¥æŸ¥è¯¢ï¼Œå¦‚æœç”¨æˆ·ä¸€ç›´åœ¨è¾“å…¥ä¸­ï¼Œæ²¡æœ‰å¿…è¦ä¸åœåœ°è°ƒç”¨å»è¯·æ±‚æœåŠ¡ç«¯æ¥å£ï¼Œç­‰ç”¨æˆ·åœæ­¢è¾“å…¥çš„æ—¶å€™ï¼Œå†è°ƒç”¨ï¼Œè®¾ç½®ä¸€ä¸ªåˆé€‚çš„æ—¶é—´é—´éš”ï¼Œæœ‰æ•ˆå‡è½»æœåŠ¡ç«¯å‹åŠ›ã€‚
2. è¡¨å•éªŒè¯
3. æŒ‰é’®æäº¤äº‹ä»¶ã€‚
4. æµè§ˆå™¨çª—å£ç¼©æ”¾ï¼Œresizeäº‹ä»¶ç­‰ã€‚



2ã€**èŠ‚æµ**

> é«˜é¢‘äº‹ä»¶è§¦å‘ï¼Œä½†åœ¨nç§’å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥èŠ‚æµä¼šç¨€é‡Šå‡½æ•°çš„æ‰§è¡Œé¢‘ç‡

æ€è·¯ï¼š

> æ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶éƒ½åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰ç­‰å¾…æ‰§è¡Œçš„å»¶æ—¶å‡½æ•°

```js
  function throttle(fn,delay) {
        let canRun = true; // é€šè¿‡é—­åŒ…ä¿å­˜ä¸€ä¸ªæ ‡è®°
        return function () {
            if (!canRun) return; // åœ¨å‡½æ•°å¼€å¤´åˆ¤æ–­æ ‡è®°æ˜¯å¦ä¸ºtrueï¼Œä¸ä¸ºtrueåˆ™return
            canRun = false; // ç«‹å³è®¾ç½®ä¸ºfalse
            setTimeout(() => { // å°†å¤–éƒ¨ä¼ å…¥çš„å‡½æ•°çš„æ‰§è¡Œæ”¾åœ¨setTimeoutä¸­
                fn.apply(this, arguments);
            // æœ€ååœ¨setTimeoutæ‰§è¡Œå®Œæ¯•åå†æŠŠæ ‡è®°è®¾ç½®ä¸ºtrue(å…³é”®)è¡¨ç¤ºå¯ä»¥æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯äº†ã€‚å½“å®šæ—¶å™¨æ²¡æœ‰æ‰§è¡Œçš„æ—¶å€™æ ‡è®°æ°¸è¿œæ˜¯falseï¼Œåœ¨å¼€å¤´è¢«returnæ‰
            canRun = true;
        }, 500);
        };
    }
    function sayHi(e) {
        console.log(e.target.innerWidth, e.target.innerHeight);
    }
    window.addEventListener('resize', throttle(sayHi,500));
```

![mark](http://static.zxinc520.com/blog/20190921/nJbaVeD1wpaz.gif)



### [ç¬¬ 4 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/blob/master/datum/summary.md#%E7%AC%AC-4-%E9%A2%98%E4%BB%8B%E7%BB%8D%E4%B8%8B-setmapweakset-%E5%92%8C-weakmap-%E7%9A%84%E5%8C%BA%E5%88%AB) (2019/9/22)

**é¢˜ç›®** ï¼šä»‹ç»ä¸‹ Setã€Mapã€WeakSet å’Œ WeakMap çš„åŒºåˆ«ï¼Ÿ

**è§£æï¼š** [æœ¨æ˜“æ¨å‰ç«¯è¿›é˜¶](https://muyiy.cn/question/js/4.html) 

~~~txt
Set
    æˆå‘˜å”¯ä¸€ã€æ— åºä¸”ä¸é‡å¤
    [value, value]ï¼Œé”®å€¼ä¸é”®åæ˜¯ä¸€è‡´çš„ï¼ˆæˆ–è€…è¯´åªæœ‰é”®å€¼ï¼Œæ²¡æœ‰é”®åï¼‰
    å¯ä»¥éå†ï¼Œæ–¹æ³•æœ‰ï¼šaddã€deleteã€has
    
WeakSet
    æˆå‘˜éƒ½æ˜¯å¯¹è±¡
    æˆå‘˜éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼Œå¯ä»¥ç”¨æ¥ä¿å­˜DOMèŠ‚ç‚¹ï¼Œä¸å®¹æ˜“é€ æˆå†…å­˜æ³„æ¼
    ä¸èƒ½éå†ï¼Œæ–¹æ³•æœ‰addã€deleteã€has
    
Map
    æœ¬è´¨ä¸Šæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œç±»ä¼¼é›†åˆ
    å¯ä»¥éå†ï¼Œæ–¹æ³•å¾ˆå¤šå¯ä»¥è·Ÿå„ç§æ•°æ®æ ¼å¼è½¬æ¢
    
WeakMap
    åªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆnullé™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®å
    é”®åæ˜¯å¼±å¼•ç”¨ï¼Œé”®å€¼å¯ä»¥æ˜¯ä»»æ„çš„ï¼Œé”®åæ‰€æŒ‡å‘çš„å¯¹è±¡å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶é”®åæ˜¯æ— æ•ˆçš„
    ä¸èƒ½éå†ï¼Œæ–¹æ³•æœ‰getã€setã€hasã€delete
 
 Setä¸WeakSetåŒºåˆ«:
    1. WeakSetåªèƒ½å­˜æ”¾å¯¹è±¡
    2. WeakSetä¸æ”¯æŒéå†, æ²¡æœ‰sizeç†Ÿæ‚‰
    3. WeakSetå­˜æ”¾çš„å¯¹è±¡ä¸ä¼šè®¡å…¥åˆ°å¯¹è±¡çš„å¼•ç”¨æŠ€æœ¯, å› æ­¤ä¸ä¼šå½±å“GCçš„å›æ”¶
    4. WeakSetå­˜åœ¨çš„å¯¹è±¡å¦‚æœåœ¨å¤–ç•Œæ¶ˆå¤±äº†, é‚£ä¹ˆåœ¨WeakSeté‡Œé¢ä¹Ÿä¼šä¸å­˜åœ¨
    
 Mapä¸WeakMapåŒºåˆ«
 	1. WeakMapåªèƒ½æ¥å—å¯¹è±¡ä½œä¸ºé”®åå­—(nullé™¤å¤–)
	2. WeakMapé”®åæŒ‡å‘å¯¹è±¡ä¸ä¼šè®¡å…¥å¯¹è±¡çš„å¼•ç”¨æ•°
~~~



### [ç¬¬ 5 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/9) (2019/9/22)

**é¢˜ç›®ï¼š** ä»‹ç»ä¸‹æ·±åº¦ä¼˜å…ˆéå†å’Œå¹¿åº¦ä¼˜å…ˆéå†ï¼Œå¦‚ä½•å®ç°ï¼Ÿ

è§£æï¼š æˆ‘å…ˆå­¦ä¹ ä¸€ä¸‹å•¥æ˜¯  æ·±åº¦ä¼˜å…ˆ å’Œ å¹¿åº¦ä¼˜å…ˆ... æƒ­æ„§ï¼ï¼ï¼



### [ç¬¬ 6 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/10) ï¼ˆ2019/9/23ï¼‰

**é¢˜ç›®** ï¼šè¯·åˆ†åˆ«ç”¨æ·±åº¦ä¼˜å…ˆæ€æƒ³å’Œå¹¿åº¦ä¼˜å…ˆæ€æƒ³å®ç°ä¸€ä¸ªæ‹·è´å‡½æ•°ï¼Ÿ

> å¼„æ‡‚äº† ä¼˜å…ˆéå†å’Œå¹¿åº¦ä¼˜å…ˆéå† å†æ¥åš





### [ç¬¬ 7 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/20) ï¼ˆ2019/9/23ï¼‰

**é¢˜ç›®** ï¼šES5/ES6 çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**è§£æ** ï¼š [æ›´å¤š](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/20)

1. `class` å£°æ˜ä¼šæå‡ï¼Œä½†ä¸ä¼šåˆå§‹åŒ–èµ‹å€¼ã€‚`Foo` è¿›å…¥æš‚æ—¶æ€§æ­»åŒºï¼Œç±»ä¼¼äº `let`ã€`const` å£°æ˜å˜é‡ã€‚
2. `class` å£°æ˜å†…éƒ¨ä¼šå¯ç”¨ä¸¥æ ¼æ¨¡å¼ã€‚
3. `class` çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰éƒ½æ˜¯ä¸å¯æšä¸¾çš„ã€‚
4. `class` çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰éƒ½æ²¡æœ‰åŸå‹å¯¹è±¡ prototypeï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰`[[construct]]`ï¼Œä¸èƒ½ä½¿ç”¨ `new` æ¥è°ƒç”¨ã€‚
5. å¿…é¡»ä½¿ç”¨ `new` è°ƒç”¨ `class`ã€‚
6. `class` å†…éƒ¨æ— æ³•é‡å†™ç±»åã€‚



### [ç¬¬ 8 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/33)ï¼ˆ2019/9/24ï¼‰

**é¢˜ç›®ï¼š** setTimeoutã€Promiseã€Async/Await çš„åŒºåˆ« ï¼Ÿ

**çŸ¥è¯†ç‚¹** ï¼šè¿™é‡Œæ¶‰åŠåˆ°`Microtasks`ã€`Macrotasks`ã€event loop ä»¥åŠ JS çš„å¼‚æ­¥è¿è¡Œæœºåˆ¶ã€‚[å¯å‚è€ƒ](https://github.com/sisterAn/blog/issues/21) 

**è§£æ** ï¼š 

~~~txt
æˆ‘è§‰å¾—è¿™é¢˜ä¸»è¦æ˜¯è€ƒå¯Ÿè¿™ä¸‰è€…åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„åŒºåˆ«ï¼Œäº‹ä»¶å¾ªç¯ä¸­åˆ†ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚
å…¶ä¸­ setTimeoutçš„å›è°ƒå‡½æ•°æ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œç­‰åˆ°æ‰§è¡Œæ ˆæ¸…ç©ºä»¥åæ‰§è¡Œï¼›
promise.thené‡Œçš„å›è°ƒå‡½æ•°ä¼šæ”¾åˆ°ç›¸åº”å®ä»»åŠ¡çš„å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œç­‰å®ä»»åŠ¡é‡Œé¢çš„åŒæ­¥ä»£ç æ‰§è¡Œå®Œå†æ‰§è¡Œï¼›asyncå‡½æ•°è¡¨ç¤ºå‡½æ•°é‡Œé¢å¯èƒ½ä¼šæœ‰å¼‚æ­¥æ–¹æ³•ï¼Œawaitåé¢è·Ÿä¸€ä¸ªè¡¨è¾¾å¼ï¼Œasyncæ–¹æ³•æ‰§è¡Œæ—¶ï¼Œé‡åˆ°awaitä¼šç«‹å³æ‰§è¡Œè¡¨è¾¾å¼ï¼Œç„¶åæŠŠè¡¨è¾¾å¼åé¢çš„ä»£ç æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œè®©å‡ºæ‰§è¡Œæ ˆè®©åŒæ­¥ä»£ç å…ˆæ‰§è¡Œã€‚
~~~

**1ã€setTimeout**

~~~js
console.log('script start')	//1. æ‰“å° script start
setTimeout(function(){
    console.log('settimeout')	// 4. æ‰“å° settimeout
})	// 2. è°ƒç”¨ setTimeout å‡½æ•°ï¼Œå¹¶å®šä¹‰å…¶å®Œæˆåæ‰§è¡Œçš„å›è°ƒå‡½æ•°
console.log('script end')	//3. æ‰“å° script start
// è¾“å‡ºé¡ºåºï¼šscript start->script end->settimeout
~~~

**2ã€ Promise** 

Promiseæœ¬èº«æ˜¯**åŒæ­¥çš„ç«‹å³æ‰§è¡Œå‡½æ•°**ï¼Œ å½“åœ¨executorä¸­æ‰§è¡Œresolveæˆ–è€…rejectçš„æ—¶å€™, æ­¤æ—¶æ˜¯å¼‚æ­¥æ“ä½œï¼Œ ä¼šå…ˆæ‰§è¡Œthen/catchç­‰ï¼Œå½“ä¸»æ ˆå®Œæˆåï¼Œæ‰ä¼šå»è°ƒç”¨resolve/rejectä¸­å­˜æ”¾çš„æ–¹æ³•æ‰§è¡Œï¼Œæ‰“å°pçš„æ—¶å€™ï¼Œæ˜¯æ‰“å°çš„è¿”å›ç»“æœï¼Œä¸€ä¸ªPromiseå®ä¾‹ã€‚

~~~js
console.log('script start')
let promise1 = new Promise(function (resolve) {
    console.log('promise1')
    resolve()
    console.log('promise1 end')
}).then(function () {
    console.log('promise2')
})
setTimeout(function(){
    console.log('settimeout')
})
console.log('script end')
// è¾“å‡ºé¡ºåº: script start->promise1->promise1 end->script end->promise2->settimeout
~~~

å½“JSä¸»çº¿ç¨‹æ‰§è¡Œåˆ°Promiseå¯¹è±¡æ—¶ï¼Œ

- promise1.then() çš„å›è°ƒå°±æ˜¯ä¸€ä¸ª task
- promise1 æ˜¯ resolvedæˆ–rejected: é‚£è¿™ä¸ª task å°±ä¼šæ”¾å…¥å½“å‰äº‹ä»¶å¾ªç¯å›åˆçš„ microtask queue
- promise1 æ˜¯ pending: è¿™ä¸ª task å°±ä¼šæ”¾å…¥ äº‹ä»¶å¾ªç¯çš„æœªæ¥çš„æŸä¸ª(å¯èƒ½ä¸‹ä¸€ä¸ª)å›åˆçš„ microtask queue ä¸­
- setTimeout çš„å›è°ƒä¹Ÿæ˜¯ä¸ª task ï¼Œå®ƒä¼šè¢«æ”¾å…¥ macrotask queue å³ä½¿æ˜¯ 0ms çš„æƒ…å†µ

**3. async/await** 

~~~js
async function async1(){
   console.log('async1 start');
    await async2();
    console.log('async1 end')
}
async function async2(){
    console.log('async2')
}

console.log('script start');
async1();
console.log('script end')

// è¾“å‡ºé¡ºåºï¼šscript start->async1 start->async2->script end->async1 end
~~~

async å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ° await å°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°è§¦å‘çš„å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ˜¯è®©å‡ºäº†çº¿ç¨‹ï¼Œè·³å‡ºäº† async å‡½æ•°ä½“ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

~~~js
async function func1() {
    return 1
}

console.log(func1())
~~~

![mark](http://static.zxinc520.com/blog/20190924/M0YN5oCKtEhr.png?imageslim)

å¾ˆæ˜¾ç„¶ï¼Œfunc1çš„è¿è¡Œç»“æœå…¶å®å°±æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ã€‚å› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨thenæ¥å¤„ç†åç»­é€»è¾‘ã€‚

~~~js
func1().then(res => {
    console.log(res);  // 30
}
~~~

awaitçš„å«ä¹‰ä¸ºç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯ async å‡½æ•°éœ€è¦ç­‰å¾…awaitåçš„å‡½æ•°æ‰§è¡Œå®Œæˆå¹¶ä¸”æœ‰äº†è¿”å›ç»“æœï¼ˆPromiseå¯¹è±¡ï¼‰ä¹‹åï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚awaité€šè¿‡è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡æ¥å®ç°åŒæ­¥çš„æ•ˆæœã€‚

> æ›´å¤šå¯è§ [setTimeoutã€Promiseã€Async/Await](https://github.com/sisterAn/blog/issues/21)



### [ç¬¬ 9 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/33)ï¼ˆ2019/9/25ï¼‰

**é¢˜ç›®** ï¼š Async/Await å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥ï¼Ÿ

**å…¬å¸** ï¼šå¤´æ¡ã€å¾®åŒ»   

**è§£æ** ï¼š  [Async/Await å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥](Async/Await å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥) 

é¦–å…ˆï¼Œ`async/await` æ˜¯ `Generator` çš„è¯­æ³•ç³–

å…ˆæ¥çœ‹ä¸€ä¸‹äºŒè€…çš„å¯¹æ¯”ï¼š

~~~JS
// Generator
run(function*() {
  const res1 = yield readFile(path.resolve(__dirname, '../data/a.json'), { encoding: 'utf8' });
  console.log(res1);
  const res2 = yield readFile(path.resolve(__dirname, '../data/b.json'), { encoding: 'utf8' });
  console.log(res2);
});

// async/await
const readFile = async ()=>{
  const res1 = await readFile(path.resolve(__dirname, '../data/a.json'), { encoding: 'utf8' });
  console.log(res1);
  const res2 = await readFile(path.resolve(__dirname, '../data/b.json'), { encoding: 'utf8' });
  console.log(res2);
  return 'done'ï¼›
}
const res = readFile();
~~~

å¯ä»¥çœ‹åˆ°ï¼Œ`async function` ä»£æ›¿äº† `function*`ï¼Œ`await` ä»£æ›¿äº† `yield`ï¼ŒåŒæ—¶ä¹Ÿæ— éœ€è‡ªå·±æ‰‹å†™ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨ `run` äº†

ç°åœ¨å†æ¥çœ‹çœ‹`async/await` çš„ç‰¹ç‚¹ï¼š

- å½“ `await` åé¢è·Ÿçš„æ˜¯ Promise å¯¹è±¡æ—¶ï¼Œæ‰ä¼šå¼‚æ­¥æ‰§è¡Œï¼Œå…¶å®ƒç±»å‹çš„æ•°æ®ä¼šåŒæ­¥æ‰§è¡Œ
- æ‰§è¡Œ `const res = readFile();` è¿”å›çš„ä»ç„¶æ˜¯ä¸ª Promise å¯¹è±¡ï¼Œä¸Šé¢ä»£ç ä¸­çš„ `return 'done';` ä¼šç›´æ¥è¢«ä¸‹é¢ `then` å‡½æ•°æ¥æ”¶åˆ°

~~~JS
res.then(data => {
  console.log(data); // done
});
~~~



### [ç¬¬ 10 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/7)ï¼ˆ2019/9/26ï¼‰

**é¢˜ç›®ç±»å‹** ï¼šå¼‚æ­¥ç¬”è¯•é¢˜

**å…¬å¸** ï¼šå¤´æ¡

> è¯·å†™å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœ
>

~~~js
async function async1() {
    console.log('async1 start');
    await async2();
    console.log('async1 end');
}
async function async2() {
    console.log('async2');
}
console.log('script start');
setTimeout(function() {
    console.log('setTimeout');
}, 0)
async1();
new Promise(function(resolve) {
    console.log('promise1');
    resolve();
}).then(function() {
    console.log('promise2');
});
console.log('script end');
/*  
    script start
    async1 start
    async2
    promise1
    script end
    async1 end
    promise2
    setTimeout
*/
~~~



### [ç¬¬ 11 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/8) ï¼ˆ2019/9/26ï¼‰

**å…¬å¸** ï¼šæºç¨‹

> å·²çŸ¥å¦‚ä¸‹æ•°ç»„ï¼š
>
> var arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10];
>
> ç¼–å†™ä¸€ä¸ªç¨‹åºå°†æ•°ç»„æ‰å¹³åŒ–å»å¹¶é™¤å…¶ä¸­é‡å¤éƒ¨åˆ†æ•°æ®ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå‡åºä¸”ä¸é‡å¤çš„æ•°ç»„

~~~js
Array.from(new Set(arr.flat(Infinity))).sort((a,b)=>{ return a-b}) //ä½¿ç”¨ flat
//æˆ–
Array.from(new Set(arr.toString().split(','))).sort((a,b)=>{return a-b}).map(Number) //åˆ©ç”¨ toString()
~~~



### [ç¬¬ 12 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/11) ï¼ˆ2019/9/27ï¼‰

**é¢˜ç›®ï¼š** JS å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹ã€‚

**å…¬å¸** ï¼šæ»´æ»´ã€æŒ–è´¢ã€å¾®åŒ»ã€æµ·åº·

**è§£æï¼š** 

1. **å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰** 

~~~js
setTimeout(() => {
    // callback å‡½æ•°ä½“
}, 1000)
~~~

**ç¼ºç‚¹**ï¼šå›è°ƒåœ°ç‹±ï¼Œä¸èƒ½ç”¨ try catch æ•è·é”™è¯¯ï¼Œä¸èƒ½ return 

å›è°ƒåœ°ç‹±çš„æ ¹æœ¬é—®é¢˜åœ¨äºï¼š

- ç¼ºä¹é¡ºåºæ€§ï¼š å›è°ƒåœ°ç‹±å¯¼è‡´çš„è°ƒè¯•å›°éš¾ï¼Œå’Œå¤§è„‘çš„æ€ç»´æ–¹å¼ä¸ç¬¦
- åµŒå¥—å‡½æ•°å­˜åœ¨è€¦åˆæ€§ï¼Œä¸€æ—¦æœ‰æ‰€æ”¹åŠ¨ï¼Œå°±ä¼šç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œå³ï¼ˆ**æ§åˆ¶åè½¬**ï¼‰
- åµŒå¥—å‡½æ•°è¿‡å¤šçš„å¤šè¯ï¼Œå¾ˆéš¾å¤„ç†é”™è¯¯

**ä¼˜ç‚¹** ï¼šè§£å†³äº†åŒæ­¥çš„é—®é¢˜ï¼ˆåªè¦æœ‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼Œåé¢çš„ä»»åŠ¡éƒ½å¿…é¡»æ’é˜Ÿç­‰ç€ï¼Œä¼šæ‹–å»¶æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œã€‚ï¼‰

2. **Promise** 

Promiseå°±æ˜¯ä¸ºäº†è§£å†³callbackçš„é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚

Promise å®ç°äº†é“¾å¼è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡ then åè¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªå…¨æ–° Promiseï¼Œå¦‚æœæˆ‘ä»¬åœ¨ then ä¸­ return ï¼Œreturn çš„ç»“æœä¼šè¢« Promise.resolve() åŒ…è£…

**ä¼˜ç‚¹** ï¼šè§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜

~~~js
ajax('XXX1')
  .then(res => {
      // æ“ä½œé€»è¾‘
      return ajax('XXX2')
  }).then(res => {
      // æ“ä½œé€»è¾‘
      return ajax('XXX3')
  }).then(res => {
      // æ“ä½œé€»è¾‘
  })
~~~

**ç¼ºç‚¹** ï¼šæ— æ³•å–æ¶ˆ Promise ï¼Œé”™è¯¯éœ€è¦é€šè¿‡å›è°ƒå‡½æ•°æ¥æ•è·

3. **Generato** 

**ç‰¹ç‚¹** ï¼šå¯ä»¥æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œï¼Œå¯ä»¥é…åˆ co å‡½æ•°åº“ä½¿ç”¨

~~~js
function *fetch() {
    yield ajax('XXX1', () => {})
    yield ajax('XXX2', () => {})
    yield ajax('XXX3', () => {})
}
let it = fetch()
let result1 = it.next()
let result2 = it.next()
let result3 = it.next()
~~~

4. **Async/await** 

asyncã€await æ˜¯å¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ

**ä¼˜ç‚¹**ï¼šä»£ç æ¸…æ™°ï¼Œä¸ç”¨åƒ Promise å†™ä¸€å¤§å † then é“¾ï¼Œå¤„ç†äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜

**ç¼ºç‚¹**ï¼šawait å°†å¼‚æ­¥ä»£ç æ”¹é€ æˆåŒæ­¥ä»£ç ï¼Œå¦‚æœå¤šä¸ªå¼‚æ­¥æ“ä½œæ²¡æœ‰ä¾èµ–æ€§è€Œä½¿ç”¨ await ä¼šå¯¼è‡´æ€§èƒ½ä¸Šçš„é™ä½ã€‚

~~~js
async function test() {
  // ä»¥ä¸‹ä»£ç æ²¡æœ‰ä¾èµ–æ€§çš„è¯ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ Promise.all çš„æ–¹å¼
  // å¦‚æœæœ‰ä¾èµ–æ€§çš„è¯ï¼Œå…¶å®å°±æ˜¯è§£å†³å›è°ƒåœ°ç‹±çš„ä¾‹å­äº†
  await fetch('XXX1')
  await fetch('XXX2')
  await fetch('XXX3')
}
~~~

ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä½¿ç”¨ `await` çš„ä¾‹å­ï¼š

~~~js
let a = 0
let b = async () => {
  a = a + await 10
  console.log('2', a) // -> '2' 10
}
b()
a++
console.log('1', a) // -> '1' 1
~~~

å¯¹äºä»¥ä¸Šä»£ç ä½ å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸‹åŸå› 

- é¦–å…ˆå‡½æ•° `b` å…ˆæ‰§è¡Œï¼Œåœ¨æ‰§è¡Œåˆ° `await 10` ä¹‹å‰å˜é‡ `a` è¿˜æ˜¯ 0ï¼Œå› ä¸º `await` å†…éƒ¨å®ç°äº† `generator` ï¼Œ**generator ä¼šä¿ç•™å †æ ˆä¸­ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™æ—¶å€™ a = 0 è¢«ä¿å­˜äº†ä¸‹æ¥**
- å› ä¸º `await` æ˜¯å¼‚æ­¥æ“ä½œï¼Œåæ¥çš„è¡¨è¾¾å¼ä¸è¿”å› `Promise` çš„è¯ï¼Œå°±ä¼šåŒ…è£…æˆ `Promise.reslove(è¿”å›å€¼)`ï¼Œç„¶åä¼šå»æ‰§è¡Œå‡½æ•°å¤–çš„åŒæ­¥ä»£ç 
- åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•åå¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå°†ä¿å­˜ä¸‹æ¥çš„å€¼æ‹¿å‡ºæ¥ä½¿ç”¨ï¼Œè¿™æ—¶å€™ `a = 0 + 10`

ä¸Šè¿°è§£é‡Šä¸­æåˆ°äº† `await` å†…éƒ¨å®ç°äº† `generator`ï¼Œå…¶å® `await` å°±æ˜¯ `generator` åŠ ä¸Š `Promise`çš„è¯­æ³•ç³–ï¼Œä¸”å†…éƒ¨å®ç°äº†è‡ªåŠ¨æ‰§è¡Œ `generator`ã€‚å¦‚æœä½ ç†Ÿæ‚‰ co çš„è¯ï¼Œå…¶å®è‡ªå·±å°±å¯ä»¥å®ç°è¿™æ ·çš„è¯­æ³•ç³–ã€‚



### [ç¬¬ 13 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/19) ï¼ˆ2019/9/28ï¼‰

**é¢˜ç›®** ï¼šPromise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆ then æ–¹æ³•å‘¢ï¼Ÿ

**å…¬å¸** ï¼šå¾®åŒ»

~~~txt
çœ‹è¿‡ Event Loop åŸºç¡€åŸç†çš„å°±æ˜ç™½ï¼ŒPromiseæ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œï¼Œè€Œ .then .catch .å•¥å•¥çš„æ˜¯å¼‚æ­¥ï¼ˆè¿˜æœ‰process.nextTickç­‰ç­‰ï¼Œå¤§å®¶å¯ä»¥æŸ¥ï¼‰ï¼Œ
è€Œä¸”æ”¾åˆ°äº†å¾®é˜Ÿåˆ—ä¸­ï¼Œasync/await ä¸­ï¼Œawait å‰é¢çš„æ˜¯åŒæ­¥ï¼Œawait åé¢çš„æ˜¯å¼‚æ­¥ï¼Œå†™æ³•ä¸Šæ˜¯è¿™æ ·ï¼Œä½†æ˜¯å…¶å®æ˜¯ è¯­æ³•ç³–ï¼Œæœ€åè¿˜ä¼šè½¬ä¸º Promise.thençš„å½¢å¼

.then()å½“ç„¶æ˜¯åŒæ­¥æ‰§è¡Œï¼Œåªä¸è¿‡æ˜¯.thençš„cbè¢«æ”¾å…¥äº†å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œäº§ç”Ÿäº†å¼‚æ­¥æ‰§è¡Œ

promiseæ˜¯å¾®è§‚ä»»åŠ¡ï¼ŒsetTimeoutæ˜¯å®è§‚ä»»åŠ¡ï¼Œå…ˆæ‰§è¡Œå¾®è§‚ä»»åŠ¡ï¼Œåœ¨æ‰§è¡Œå®è§‚ä»»åŠ¡ï¼›å¾®è§‚ä»»åŠ¡é‡Œï¼Œå…ˆæ‰§è¡ŒåŒæ­¥å†æ‰§è¡Œå¼‚æ­¥
~~~





### [ç¬¬ 14 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/12) ï¼ˆ2019/9/29ï¼‰

**é¢˜ç›®** ï¼šæƒ…äººèŠ‚ç¦åˆ©é¢˜ï¼Œå¦‚ä½•å®ç°ä¸€ä¸ª new ï¼Ÿ

**å…¬å¸**ï¼šå…‘å§

**è§£æ** ï¼š  [newåˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆ](https://alexzhong22c.github.io/2017/08/12/js-new-happen/#%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%BB%93%E6%9E%9C%E8%A7%A3%E6%9E%90)

~~~js
// new çš„ä½œç”¨
// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡obj
// æŠŠobjçš„__proto__æŒ‡å‘Dog.prototype å®ç°ç»§æ‰¿
// æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œä¼ é€’å‚æ•°ï¼Œæ”¹å˜thisæŒ‡å‘ Dog.call(obj, ...args)
// æœ€åæŠŠobjèµ‹å€¼ç»™sanmao
var _new = function() {
  let constructor = Array.prototype.shift.call(arguments)
  let args = arguments
  const obj = new Object()
  obj.__proto__ = constructor.prototype
  constructor.call(obj, ...args)
  return obj
}
var simao = _new(Dog, 'simao')
simao.bark()
simao.sayName()
console.log(simao instanceof Dog) // true
~~~

~~~js
// è¿™æ ·å†™æ˜¯ä¸æ˜¯ç®€å•ç‚¹å•Š
function _new(fn, ...arg) {
    const obj = Object.create(fn.prototype);
    const ret = fn.apply(obj, arg);
    return ret instanceof Object ? ret : obj;
}
~~~



### [ç¬¬ 15 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/14) ï¼ˆ2019/9/30ï¼‰

**é¢˜ç›®** ï¼šç®€å•è®²è§£ä¸€ä¸‹http2çš„å¤šè·¯å¤ç”¨

**å…¬å¸**ï¼šç½‘æ˜“ 

**è§£æ** ï¼š

~~~txt
åœ¨ HTTP/1 ä¸­ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šå»ºç«‹ä¸€æ¬¡HTTPè¿æ¥ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„3æ¬¡æ¡æ‰‹4æ¬¡æŒ¥æ‰‹ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨ä¸€æ¬¡è¯·æ±‚è¿‡ç¨‹ä¸­å ç”¨äº†ç›¸å½“é•¿çš„æ—¶é—´ï¼Œå³ä½¿å¼€å¯äº† Keep-Alive ï¼Œè§£å†³äº†å¤šæ¬¡è¿æ¥çš„é—®é¢˜ï¼Œä½†æ˜¯ä¾ç„¶æœ‰ä¸¤ä¸ªæ•ˆç‡ä¸Šçš„é—®é¢˜ï¼š

    ç¬¬ä¸€ä¸ªï¼šä¸²è¡Œçš„æ–‡ä»¶ä¼ è¾“ã€‚å½“è¯·æ±‚aæ–‡ä»¶æ—¶ï¼Œbæ–‡ä»¶åªèƒ½ç­‰å¾…ï¼Œç­‰å¾…aè¿æ¥åˆ°æœåŠ¡å™¨ã€æœåŠ¡å™¨å¤„ç†æ–‡ä»¶ã€æœåŠ¡å™¨è¿”å›æ–‡ä»¶ï¼Œè¿™ä¸‰ä¸ªæ­¥éª¤ã€‚æˆ‘ä»¬å‡è®¾è¿™ä¸‰æ­¥ç”¨æ—¶éƒ½æ˜¯1ç§’ï¼Œé‚£ä¹ˆaæ–‡ä»¶ç”¨æ—¶ä¸º3ç§’ï¼Œbæ–‡ä»¶ä¼ è¾“å®Œæˆç”¨æ—¶ä¸º6ç§’ï¼Œä¾æ­¤ç±»æ¨ã€‚ï¼ˆæ³¨ï¼šæ­¤é¡¹è®¡ç®—æœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ˜¯å•é€šé“ä¼ è¾“ï¼‰
    
    ç¬¬äºŒä¸ªï¼šè¿æ¥æ•°è¿‡å¤šã€‚æˆ‘ä»¬å‡è®¾Apacheè®¾ç½®äº†æœ€å¤§å¹¶å‘æ•°ä¸º300ï¼Œå› ä¸ºæµè§ˆå™¨é™åˆ¶ï¼Œæµè§ˆå™¨å‘èµ·çš„æœ€å¤§è¯·æ±‚æ•°ä¸º6ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨èƒ½æ‰¿è½½çš„æœ€é«˜å¹¶å‘ä¸º50ï¼Œå½“ç¬¬51ä¸ªäººè®¿é—®æ—¶ï¼Œå°±éœ€è¦ç­‰å¾…å‰é¢æŸä¸ªè¯·æ±‚å¤„ç†å®Œæˆã€‚
    
HTTP/2çš„å¤šè·¯å¤ç”¨å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šè¿°çš„ä¸¤ä¸ªæ€§èƒ½é—®é¢˜ã€‚
åœ¨ HTTP/2 ä¸­ï¼Œæœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯å¸§ï¼ˆframeï¼‰å’Œæµï¼ˆstreamï¼‰ã€‚
å¸§ä»£è¡¨ç€æœ€å°çš„æ•°æ®å•ä½ï¼Œæ¯ä¸ªå¸§ä¼šæ ‡è¯†å‡ºè¯¥å¸§å±äºå“ªä¸ªæµï¼Œæµä¹Ÿå°±æ˜¯å¤šä¸ªå¸§ç»„æˆçš„æ•°æ®æµã€‚
å¤šè·¯å¤ç”¨ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­å¯ä»¥å­˜åœ¨å¤šæ¡æµã€‚æ¢å¥è¯è¯´ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå¯¹ç«¯å¯ä»¥é€šè¿‡å¸§ä¸­çš„æ ‡è¯†çŸ¥é“å±äºå“ªä¸ªè¯·æ±‚ã€‚é€šè¿‡è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥é¿å… HTTP æ—§ç‰ˆæœ¬ä¸­çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ï¼Œæå¤§çš„æé«˜ä¼ è¾“æ€§èƒ½ã€‚
~~~



### [ç¬¬ 16 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/15) ï¼ˆ2019/10/01ï¼‰

**é¢˜ç›®** ï¼šè°ˆè°ˆä½ å¯¹TCPä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹çš„ç†è§£

**è§£æ** ï¼š[å…³äºä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹é¢è¯•å®˜æƒ³è€ƒæˆ‘ä»¬ä»€ä¹ˆï¼Ÿ--- ä¸çœ‹åæ‚”ç³»åˆ—](https://juejin.im/post/5ccd0dfc6fb9a0324a08bb73)

ä¸‰æ¬¡æ¡æ‰‹ï¼š

1. ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ª SYN æŠ¥æ–‡ã€‚

2. ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ° SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šåº”ç­”ä¸€ä¸ª SYN+ACK æŠ¥æ–‡ã€‚

3. ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° SYN+ACK æŠ¥æ–‡ä¹‹åï¼Œä¼šå›åº”ä¸€ä¸ª ACK æŠ¥æ–‡ã€‚

4. æœåŠ¡å™¨æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œä¸‰æ¬¡æ¡æ‰‹å»ºç«‹å®Œæˆã€‚

> **è¿™é‡Œæˆ‘é¡ºä¾¿è§£é‡Šä¸€ä¸‹ä¸ºå•¥åªæœ‰ä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½ç¡®è®¤åŒæ–¹çš„æ¥å—ä¸å‘é€èƒ½åŠ›æ˜¯å¦æ­£å¸¸ï¼Œè€Œä¸¤æ¬¡å´ä¸å¯ä»¥**ï¼š
>  ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ç½‘ç»œåŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„å‘é€èƒ½åŠ›ã€æœåŠ¡ç«¯çš„æ¥æ”¶èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚
>  ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯å‘åŒ…ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·å®¢æˆ·ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šæœåŠ¡ç«¯çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›ï¼Œå®¢æˆ·ç«¯çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚ä¸è¿‡æ­¤æ—¶æœåŠ¡å™¨å¹¶ä¸èƒ½ç¡®è®¤å®¢æˆ·ç«¯çš„æ¥æ”¶èƒ½åŠ›æ˜¯å¦æ­£å¸¸ã€‚
>  ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘åŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ­£å¸¸ï¼ŒæœåŠ¡å™¨è‡ªå·±çš„å‘é€ã€æ¥æ”¶èƒ½åŠ›ä¹Ÿæ­£å¸¸ã€‚

å››æ¬¡æŒ¥æ‰‹:

1. ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ª FIN æŠ¥æ–‡ï¼ŒæŠ¥æ–‡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº**FIN_WAIT1**çŠ¶æ€ã€‚

2. ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¼šå‘é€ ACK æŠ¥æ–‡ï¼Œä¸”æŠŠå®¢æˆ·ç«¯çš„åºåˆ—å·å€¼ + 1 ä½œä¸º ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œè¡¨æ˜å·²ç»æ”¶åˆ°å®¢æˆ·ç«¯çš„æŠ¥æ–‡äº†ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å¤„äº **CLOSE_WAIT**çŠ¶æ€ã€‚

3. ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šå¦‚æœæœåŠ¡ç«¯ä¹Ÿæƒ³æ–­å¼€è¿æ¥äº†ï¼Œå’Œå®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ä¸€æ ·ï¼Œå‘ç»™ FIN æŠ¥æ–‡ï¼Œä¸”æŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶æœåŠ¡ç«¯å¤„äº **LAST_ACK** çš„çŠ¶æ€ã€‚

4. ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¸€æ ·å‘é€ä¸€ä¸ª ACK æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œä¸”æŠŠæœåŠ¡ç«¯çš„åºåˆ—å·å€¼ + 1 ä½œä¸ºè‡ªå·± ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº **TIME_WAIT** çŠ¶æ€ã€‚éœ€è¦è¿‡ä¸€é˜µå­ä»¥ç¡®ä¿æœåŠ¡ç«¯æ”¶åˆ°è‡ªå·±çš„ ACK æŠ¥æ–‡ä¹‹åæ‰ä¼šè¿›å…¥ CLOSED çŠ¶æ€

5. æœåŠ¡ç«¯æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œå°±å¤„äºå…³é—­è¿æ¥äº†ï¼Œå¤„äº CLOSED çŠ¶æ€ã€‚

è¿™é‡Œç‰¹åˆ«éœ€è¦ä¸»è¦çš„å°±æ˜¯**TIME_WAIT**è¿™ä¸ªçŠ¶æ€äº†ï¼Œè¿™ä¸ªæ˜¯é¢è¯•çš„é«˜é¢‘è€ƒç‚¹ï¼Œå°±æ˜¯è¦ç†è§£ï¼Œä¸ºä»€ä¹ˆå®¢æˆ·ç«¯å‘é€ ACK ä¹‹åä¸ç›´æ¥å…³é—­ï¼Œè€Œæ˜¯è¦ç­‰ä¸€é˜µå­æ‰å…³é—­ã€‚è¿™å…¶ä¸­çš„åŸå› å°±æ˜¯ï¼Œè¦ç¡®ä¿æœåŠ¡å™¨æ˜¯å¦å·²ç»æ”¶åˆ°äº†æˆ‘ä»¬çš„ ACK æŠ¥æ–‡ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°çš„è¯ï¼ŒæœåŠ¡å™¨ä¼šé‡æ–°å‘ FIN æŠ¥æ–‡ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å†æ¬¡æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œå°±çŸ¥é“ä¹‹å‰çš„ ACK æŠ¥æ–‡ä¸¢å¤±äº†ï¼Œç„¶åå†æ¬¡å‘é€ ACK æŠ¥æ–‡ã€‚

è‡³äº TIME_WAIT æŒç»­çš„æ—¶é—´è‡³å°‘æ˜¯ä¸€ä¸ªæŠ¥æ–‡çš„æ¥å›æ—¶é—´ã€‚ä¸€èˆ¬ä¼šè®¾ç½®ä¸€ä¸ªè®¡æ—¶ï¼Œå¦‚æœè¿‡äº†è¿™ä¸ªè®¡æ—¶æ²¡æœ‰å†æ¬¡æ”¶åˆ° FIN æŠ¥æ–‡ï¼Œåˆ™ä»£è¡¨å¯¹æ–¹æˆåŠŸå°±æ˜¯ ACK æŠ¥æ–‡ï¼Œæ­¤æ—¶å¤„äº CLOSED çŠ¶æ€ã€‚



### [ç¬¬ 17 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/21) ï¼ˆ2019/10/08ï¼‰

**é¢˜ç›®** ï¼š  Aã€B æœºå™¨æ­£å¸¸è¿æ¥åï¼ŒB æœºå™¨çªç„¶é‡å¯ï¼Œé—® A æ­¤æ—¶å¤„äº TCP ä»€ä¹ˆçŠ¶æ€ ï¼Ÿ

> å¦‚æœA ä¸ B å»ºç«‹äº†æ­£å¸¸è¿æ¥åï¼Œä»æœªç›¸äº’å‘è¿‡æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ B çªç„¶æœºå™¨é‡å¯ï¼Œé—® A æ­¤æ—¶å¤„äº TCP ä»€ä¹ˆçŠ¶æ€ï¼Ÿå¦‚ä½•æ¶ˆé™¤æœåŠ¡å™¨ç¨‹åºä¸­çš„è¿™ä¸ªçŠ¶æ€ï¼Ÿï¼ˆè¶…çº²é¢˜ï¼Œäº†è§£å³å¯ï¼‰





### [ç¬¬ 18 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/17) ï¼ˆ2019/10/08ï¼‰

**é¢˜ç›®** ï¼šReact ä¸­ setState ä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥çš„ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼Ÿ

**å…¬å¸** ï¼šå¾®åŒ»    [Reactä¸­setStateçœŸçš„æ˜¯å¼‚æ­¥çš„å—](https://juejin.im/post/5ac1aaad6fb9a028d444bb87) 

~~~txt
1.åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸­æˆ–è€…reactäº‹ä»¶ç»‘å®šä¸­ï¼ŒsetStateæ˜¯é€šè¿‡å¼‚æ­¥æ›´æ–°çš„ã€‚
2.åœ¨å»¶æ—¶çš„å›è°ƒæˆ–è€…åŸç”Ÿäº‹ä»¶ç»‘å®šçš„å›è°ƒä¸­è°ƒç”¨setStateä¸ä¸€å®šæ˜¯å¼‚æ­¥çš„ã€‚
è¿™ä¸ªç»“æœå¹¶ä¸è¯´æ˜setStateå¼‚æ­¥æ‰§è¡Œçš„è¯´æ³•æ˜¯é”™è¯¯çš„ï¼Œæ›´åŠ å‡†ç¡®çš„è¯´æ³•åº”è¯¥æ˜¯setStateä¸èƒ½ä¿è¯åŒæ­¥æ‰§è¡Œã€‚
Dan Abramovä¹Ÿå¤šæ¬¡æåˆ°ä»Šåä¼šå°†setStateå½»åº•æ”¹é€ ä¸ºå¼‚æ­¥çš„ï¼Œä»js confä¸­æåˆ°çš„suspendæ–°ç‰¹æ–°ä¹Ÿå°è¯äº†è¿™ä¸€ç‚¹ã€‚
~~~

~~~txt
è¿™é‡Œæ‰€è¯´çš„åŒæ­¥å¼‚æ­¥ï¼Œå¹¶éçœŸæ­£çš„åŒæ­¥å¼‚æ­¥ï¼Œé€šå¸¸æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚
è¿™é‡Œçš„å¼‚æ­¥æŒ‡çš„æ˜¯å¤šä¸ªçŠ¶æ€ä¼šåˆæˆåˆ°ä¸€èµ·è¿›è¡Œæ‰¹é‡æ›´æ–°ã€‚
~~~



### [ç¬¬ 19 é¢˜ ](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/18) ï¼ˆ2019/10/08ï¼‰

**é¢˜ç›®** ï¼šReact setState ç¬”è¯•é¢˜ï¼Œä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ

~~~js
class Example extends React.Component {
  constructor() {
    super();
    this.state = {
      val: 0
    };
  }
  
  componentDidMount() {
    this.setState({val: this.state.val + 1});
    console.log(this.state.val);    // ç¬¬ 1 æ¬¡ log

    this.setState({val: this.state.val + 1});
    console.log(this.state.val);    // ç¬¬ 2 æ¬¡ log

    setTimeout(() => {
      this.setState({val: this.state.val + 1});
      console.log(this.state.val);  // ç¬¬ 3 æ¬¡ log

      this.setState({val: this.state.val + 1});
      console.log(this.state.val);  // ç¬¬ 4 æ¬¡ log
    }, 0);
  }

  render() {
    return null;
  }
};
~~~

~~~js
1ã€ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡éƒ½æ˜¯åœ¨ react è‡ªèº«ç”Ÿå‘½å‘¨æœŸå†…ï¼Œè§¦å‘æ—¶ isBatchingUpdates ä¸º trueï¼Œæ‰€ä»¥å¹¶ä¸ä¼šç›´æ¥æ‰§è¡Œæ›´æ–° stateï¼Œè€Œæ˜¯åŠ å…¥äº† dirtyComponentsï¼Œæ‰€ä»¥æ‰“å°æ—¶è·å–çš„éƒ½æ˜¯æ›´æ–°å‰çš„çŠ¶æ€ 0ã€‚

2ã€ä¸¤æ¬¡ setState æ—¶ï¼Œè·å–åˆ° this.state.val éƒ½æ˜¯ 0ï¼Œæ‰€ä»¥æ‰§è¡Œæ—¶éƒ½æ˜¯å°† 0 è®¾ç½®æˆ 1ï¼Œåœ¨ react å†…éƒ¨ä¼šè¢«åˆå¹¶æ‰ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚è®¾ç½®å®Œæˆå state.val å€¼ä¸º 1ã€‚

3ã€setTimeout ä¸­çš„ä»£ç ï¼Œè§¦å‘æ—¶ isBatchingUpdates ä¸º falseï¼Œæ‰€ä»¥èƒ½å¤Ÿç›´æ¥è¿›è¡Œæ›´æ–°ï¼Œæ‰€ä»¥è¿ç€è¾“å‡º 2ï¼Œ3ã€‚

//è¾“å‡ºï¼š 0 0 2 3
~~~



### [ç¬¬ 20 é¢˜  ](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/22) ï¼ˆ2019/10/09ï¼‰

**é¢˜ç›®** ï¼šä»‹ç»ä¸‹ npm æ¨¡å—å®‰è£…æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¾“å…¥ npm install å°±å¯ä»¥è‡ªåŠ¨å®‰è£…å¯¹åº”çš„æ¨¡å—ï¼Ÿ

 **è§£æ** ï¼š

**1ã€npm æ¨¡å—å®‰è£…æœºåˆ¶ï¼š**

- å‘å‡º`npm install`å‘½ä»¤
- æŸ¥è¯¢node_modulesç›®å½•ä¹‹ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŒ‡å®šæ¨¡å—
  - è‹¥å­˜åœ¨ï¼Œä¸å†é‡æ–°å®‰è£…
  - è‹¥ä¸å­˜åœ¨
    - npm å‘ registry æŸ¥è¯¢æ¨¡å—å‹ç¼©åŒ…çš„ç½‘å€
    - ä¸‹è½½å‹ç¼©åŒ…ï¼Œå­˜æ”¾åœ¨æ ¹ç›®å½•ä¸‹çš„`.npm`ç›®å½•é‡Œ
    - è§£å‹å‹ç¼©åŒ…åˆ°å½“å‰é¡¹ç›®çš„`node_modules`ç›®å½•

**2ã€npm å®ç°åŸç†** 

è¾“å…¥ npm install å‘½ä»¤å¹¶æ•²ä¸‹å›è½¦åï¼Œä¼šç»å†å¦‚ä¸‹å‡ ä¸ªé˜¶æ®µï¼ˆä»¥ npm 5.5.1 ä¸ºä¾‹ï¼‰ï¼š

1.  **æ‰§è¡Œå·¥ç¨‹è‡ªèº« preinstall**

å½“å‰ npm å·¥ç¨‹å¦‚æœå®šä¹‰äº† preinstall é’©å­æ­¤æ—¶ä¼šè¢«æ‰§è¡Œã€‚

2. **ç¡®å®šé¦–å±‚ä¾èµ–æ¨¡å—**

é¦–å…ˆéœ€è¦åšçš„æ˜¯ç¡®å®šå·¥ç¨‹ä¸­çš„é¦–å±‚ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯ dependencies å’Œ devDependencies å±æ€§ä¸­ç›´æ¥æŒ‡å®šçš„æ¨¡å—ï¼ˆå‡è®¾æ­¤æ—¶æ²¡æœ‰æ·»åŠ  npm install å‚æ•°ï¼‰ã€‚

å·¥ç¨‹æœ¬èº«æ˜¯æ•´æ£µä¾èµ–æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œæ¯ä¸ªé¦–å±‚ä¾èµ–æ¨¡å—éƒ½æ˜¯æ ¹èŠ‚ç‚¹ä¸‹é¢çš„ä¸€æ£µå­æ ‘ï¼Œnpm ä¼šå¼€å¯å¤šè¿›ç¨‹ä»æ¯ä¸ªé¦–å±‚ä¾èµ–æ¨¡å—å¼€å§‹é€æ­¥å¯»æ‰¾æ›´æ·±å±‚çº§çš„èŠ‚ç‚¹ã€‚

3. **è·å–æ¨¡å—**

è·å–æ¨¡å—æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

- è·å–æ¨¡å—ä¿¡æ¯ã€‚åœ¨ä¸‹è½½ä¸€ä¸ªæ¨¡å—ä¹‹å‰ï¼Œé¦–å…ˆè¦ç¡®å®šå…¶ç‰ˆæœ¬ï¼Œè¿™æ˜¯å› ä¸º package.json ä¸­å¾€å¾€æ˜¯ semantic versionï¼ˆsemverï¼Œè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼‰ã€‚æ­¤æ—¶å¦‚æœç‰ˆæœ¬æè¿°æ–‡ä»¶ï¼ˆnpm-shrinkwrap.json æˆ– package-lock.jsonï¼‰ä¸­æœ‰è¯¥æ¨¡å—ä¿¡æ¯ç›´æ¥æ‹¿å³å¯ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä»ä»“åº“è·å–ã€‚å¦‚ packaeg.json ä¸­æŸä¸ªåŒ…çš„ç‰ˆæœ¬æ˜¯ ^1.1.0ï¼Œnpm å°±ä¼šå»ä»“åº“ä¸­è·å–ç¬¦åˆ 1.x.x å½¢å¼çš„æœ€æ–°ç‰ˆæœ¬ã€‚
- è·å–æ¨¡å—å®ä½“ã€‚ä¸Šä¸€æ­¥ä¼šè·å–åˆ°æ¨¡å—çš„å‹ç¼©åŒ…åœ°å€ï¼ˆresolved å­—æ®µï¼‰ï¼Œnpm ä¼šç”¨æ­¤åœ°å€æ£€æŸ¥æœ¬åœ°ç¼“å­˜ï¼Œç¼“å­˜ä¸­æœ‰å°±ç›´æ¥æ‹¿ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä»ä»“åº“ä¸‹è½½ã€‚
- æŸ¥æ‰¾è¯¥æ¨¡å—ä¾èµ–ï¼Œå¦‚æœæœ‰ä¾èµ–åˆ™å›åˆ°ç¬¬1æ­¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™åœæ­¢ã€‚

4. **æ¨¡å—æ‰å¹³åŒ–ï¼ˆdedupeï¼‰**

ä¸Šä¸€æ­¥è·å–åˆ°çš„æ˜¯ä¸€æ£µå®Œæ•´çš„ä¾èµ–æ ‘ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«å¤§é‡é‡å¤æ¨¡å—ã€‚æ¯”å¦‚ A æ¨¡å—ä¾èµ–äº loadshï¼ŒB æ¨¡å—åŒæ ·ä¾èµ–äº lodashã€‚åœ¨ npm3 ä»¥å‰ä¼šä¸¥æ ¼æŒ‰ç…§ä¾èµ–æ ‘çš„ç»“æ„è¿›è¡Œå®‰è£…ï¼Œå› æ­¤ä¼šé€ æˆæ¨¡å—å†—ä½™ã€‚

ä» npm3 å¼€å§‹é»˜è®¤åŠ å…¥äº†ä¸€ä¸ª dedupe çš„è¿‡ç¨‹ã€‚å®ƒä¼šéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œé€ä¸ªå°†æ¨¡å—æ”¾åœ¨æ ¹èŠ‚ç‚¹ä¸‹é¢ï¼Œä¹Ÿå°±æ˜¯ node-modules çš„ç¬¬ä¸€å±‚ã€‚å½“å‘ç°æœ‰**é‡å¤æ¨¡å—**æ—¶ï¼Œåˆ™å°†å…¶ä¸¢å¼ƒã€‚

è¿™é‡Œéœ€è¦å¯¹**é‡å¤æ¨¡å—**è¿›è¡Œä¸€ä¸ªå®šä¹‰ï¼Œå®ƒæŒ‡çš„æ˜¯**æ¨¡å—åç›¸åŒ**ä¸” **semver å…¼å®¹ã€‚æ¯ä¸ª semver éƒ½å¯¹åº”ä¸€æ®µç‰ˆæœ¬å…è®¸èŒƒå›´ï¼Œå¦‚æœä¸¤ä¸ªæ¨¡å—çš„ç‰ˆæœ¬å…è®¸èŒƒå›´å­˜åœ¨äº¤é›†ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå…¼å®¹**ç‰ˆæœ¬ï¼Œè€Œä¸å¿…ç‰ˆæœ¬å·å®Œå…¨ä¸€è‡´ï¼Œè¿™å¯ä»¥ä½¿æ›´å¤šå†—ä½™æ¨¡å—åœ¨ dedupe è¿‡ç¨‹ä¸­è¢«å»æ‰ã€‚

æ¯”å¦‚ node-modules ä¸‹ foo æ¨¡å—ä¾èµ– lodash@^1.0.0ï¼Œbar æ¨¡å—ä¾èµ– lodash@^1.1.0ï¼Œåˆ™ **^1.1.0** ä¸ºå…¼å®¹ç‰ˆæœ¬ã€‚

è€Œå½“ foo ä¾èµ– lodash@^2.0.0ï¼Œbar ä¾èµ– lodash@^1.1.0ï¼Œåˆ™ä¾æ® semver çš„è§„åˆ™ï¼ŒäºŒè€…ä¸å­˜åœ¨å…¼å®¹ç‰ˆæœ¬ã€‚ä¼šå°†ä¸€ä¸ªç‰ˆæœ¬æ”¾åœ¨ node_modules ä¸­ï¼Œå¦ä¸€ä¸ªä»ä¿ç•™åœ¨ä¾èµ–æ ‘é‡Œã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä¸€ä¸ªä¾èµ–æ ‘åŸæœ¬æ˜¯è¿™æ ·ï¼š

node_modules
-- foo
---- lodash@version1

-- bar
---- lodash@version2

å‡è®¾ version1 å’Œ version2 æ˜¯å…¼å®¹ç‰ˆæœ¬ï¼Œåˆ™ç»è¿‡ dedupe ä¼šæˆä¸ºä¸‹é¢çš„å½¢å¼ï¼š

node_modules
-- foo

-- bar

-- lodashï¼ˆä¿ç•™çš„ç‰ˆæœ¬ä¸ºå…¼å®¹ç‰ˆæœ¬ï¼‰

å‡è®¾ version1 å’Œ version2 ä¸ºéå…¼å®¹ç‰ˆæœ¬ï¼Œåˆ™åé¢çš„ç‰ˆæœ¬ä¿ç•™åœ¨ä¾èµ–æ ‘ä¸­ï¼š

node_modules
-- foo
-- lodash@version1

-- bar
---- lodash@version2

5. **å®‰è£…æ¨¡å—**

è¿™ä¸€æ­¥å°†ä¼šæ›´æ–°å·¥ç¨‹ä¸­çš„ node_modulesï¼Œå¹¶æ‰§è¡Œæ¨¡å—ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆæŒ‰ç…§ preinstallã€installã€postinstall çš„é¡ºåºï¼‰ã€‚

6. **æ‰§è¡Œå·¥ç¨‹è‡ªèº«ç”Ÿå‘½å‘¨æœŸ**

å½“å‰ npm å·¥ç¨‹å¦‚æœå®šä¹‰äº†é’©å­æ­¤æ—¶ä¼šè¢«æ‰§è¡Œï¼ˆæŒ‰ç…§ installã€postinstallã€prepublishã€prepare çš„é¡ºåºï¼‰ã€‚

æœ€åä¸€æ­¥æ˜¯ç”Ÿæˆæˆ–æ›´æ–°ç‰ˆæœ¬æè¿°æ–‡ä»¶ï¼Œnpm install è¿‡ç¨‹å®Œæˆã€‚

å‚è€ƒ [npm æ¨¡å—å®‰è£…æœºåˆ¶ç®€ä»‹](http://www.ruanyifeng.com/blog/2016/01/npm-install.html)

[è¯¦è§£npmçš„æ¨¡å—å®‰è£…æœºåˆ¶](https://www.bbsmax.com/A/qVdemmnEdP/)

[npm installçš„å®ç°åŸç†](https://www.zhihu.com/question/66629910)



### [ç¬¬ 21 é¢˜](https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/23)  ï¼ˆ2019/10/10ï¼‰

**é¢˜ç›®ï¼š** æœ‰ä»¥ä¸‹ 3 ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•ï¼Œè¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£

> Object.prototype.toString.call() ã€ instanceof ä»¥åŠ Array.isArray()

**è§£æï¼š**

**1ã€Object.prototype.toString.call()**  

æ¯ä¸€ä¸ªç»§æ‰¿ Object çš„å¯¹è±¡éƒ½æœ‰ `toString` æ–¹æ³•ï¼Œå¦‚æœ `toString` æ–¹æ³•æ²¡æœ‰é‡å†™çš„è¯ï¼Œä¼šè¿”å› `[Object type]`ï¼Œå…¶ä¸­ type ä¸ºå¯¹è±¡çš„ç±»å‹ã€‚ä½†å½“é™¤äº† Object ç±»å‹çš„å¯¹è±¡å¤–ï¼Œå…¶ä»–ç±»å‹ç›´æ¥ä½¿ç”¨ `toString` æ–¹æ³•æ—¶ï¼Œä¼šç›´æ¥è¿”å›éƒ½æ˜¯å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨callæˆ–è€…applyæ–¹æ³•æ¥æ”¹å˜toStringæ–¹æ³•çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚

```js
const an = ['Hello','An'];
an.toString(); // "Hello,An"
Object.prototype.toString.call(an); // "[object Array]"
```

è¿™ç§æ–¹æ³•å¯¹äºæ‰€æœ‰åŸºæœ¬çš„æ•°æ®ç±»å‹éƒ½èƒ½è¿›è¡Œåˆ¤æ–­ï¼Œå³ä½¿æ˜¯ null å’Œ undefined ã€‚

```js
Object.prototype.toString.call('An') // "[object String]"
Object.prototype.toString.call(1) // "[object Number]"
Object.prototype.toString.call(Symbol(1)) // "[object Symbol]"
Object.prototype.toString.call(null) // "[object Null]"
Object.prototype.toString.call(undefined) // "[object Undefined]"
Object.prototype.toString.call(function(){}) // "[object Function]"
Object.prototype.toString.call({name: 'An'}) // "[object Object]"
```

`Object.prototype.toString.call()` å¸¸ç”¨äºåˆ¤æ–­æµè§ˆå™¨å†…ç½®å¯¹è±¡æ—¶ã€‚

æ›´å¤šå®ç°å¯è§ [è°ˆè°ˆ Object.prototype.toString](https://juejin.im/post/591647550ce4630069df1c4a)

**2ã€instanceof** 

`instanceof`  çš„å†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯ä¸æ˜¯èƒ½æ‰¾åˆ°ç±»å‹çš„ `prototype`ã€‚

ä½¿ç”¨ `instanceof`åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„ï¼Œ`instanceof` ä¼šåˆ¤æ–­è¿™ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸Šæ˜¯å¦ä¼šæ‰¾åˆ°å¯¹åº”çš„ `Array` çš„åŸå‹ï¼Œæ‰¾åˆ°è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚

```js
[]  instanceof Array; // true
```

ä½† `instanceof` åªèƒ½ç”¨æ¥åˆ¤æ–­å¯¹è±¡ç±»å‹ï¼ŒåŸå§‹ç±»å‹ä¸å¯ä»¥ã€‚å¹¶ä¸”æ‰€æœ‰å¯¹è±¡ç±»å‹ instanceof Object éƒ½æ˜¯ trueã€‚

```js
[]  instanceof Object; // true
```

**3ã€Array.isArray()**

- åŠŸèƒ½ï¼šç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„

- instanceof ä¸ isArray

  å½“æ£€æµ‹Arrayå®ä¾‹æ—¶ï¼Œ`Array.isArray` ä¼˜äº `instanceof` ï¼Œå› ä¸º `Array.isArray` å¯ä»¥æ£€æµ‹å‡º `iframes`

  ```js
  var iframe = document.createElement('iframe');
  document.body.appendChild(iframe);
  xArray = window.frames[window.frames.length-1].Array;
  var arr = new xArray(1,2,3); // [1,2,3]
  
  // Correctly checking for Array
  Array.isArray(arr);  // true
  Object.prototype.toString.call(arr); // true
  // Considered harmful, because doesn't work though iframes
  arr instanceof Array; // false
  ```

- `Array.isArray()` ä¸ `Object.prototype.toString.call()`

  `Array.isArray()`æ˜¯ES5æ–°å¢çš„æ–¹æ³•ï¼Œå½“ä¸å­˜åœ¨ `Array.isArray()` ï¼Œå¯ä»¥ç”¨ `Object.prototype.toString.call()` å®ç°ã€‚

  ```
  if (!Array.isArray) {
    Array.isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    };
  }
  ```

  

